---
- hosts: ccportal
  gather_facts: no

  tasks:
  - name: Load global variables 
    include_vars:
      file: "{{global_config_file}}"

  - include_role: 
      name: cyclecloud
      apply: 
        become: true
    vars:
      cc_region: '{{global_region}}'
      cc_subnetid: '{{ global_resource_group }}/hpcvnet/compute'
      cc_admin_user: '{{global_admin_username}}'
      cc_public_key: '{{global_ssh_public_key}}'
      cc_password: '{{global_cc_password}}'
      cc_storage: '{{global_cc_storage}}'
      cc_queues: '{{queues}}'
      influxdb_database_name: "telegraf"
      telegraf_influxdb_urls: 
        - "http://jumpbox:8086"