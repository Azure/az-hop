---
- hosts: lustre
  become: false
  gather_facts: no
  vars_files:
    - '{{global_config_file}}'

  tasks:
  - name: Wait 300 seconds for the nodes to be ready
    wait_for_connection:
      timeout: 300
  - name: Gather facts for first time
    setup:

  - name: Ensure Lemur version
    include_role:
      name: lustre
    vars:
      install_mds: true
      install_oss: false
      install_robinhood: false

- hosts: lustre-oss-*
  become: false
  gather_facts: no
  vars_files:
    - '{{global_config_file}}'

  tasks:
  - name: Wait 300 seconds for the nodes to be ready
    wait_for_connection:
      timeout: 300
  - name: Gather facts for first time
    setup:

  - name: Ensure Lemur version
    include_role:
      name: lustre
    vars:
      install_mds: false
      install_oss: true
      install_robinhood: false

- hosts: robinhood
  become: false
  gather_facts: no
  vars_files:
    - '{{global_config_file}}'

  tasks:
  - name: Wait 300 seconds for the nodes to be ready
    wait_for_connection:
      timeout: 300
  - name: Gather facts for first time
    setup:

  - name: Ensure Lemur version
    include_role:
      name: lustre
    vars:
      install_mds: false
      install_oss: false
      install_robinhood: true

